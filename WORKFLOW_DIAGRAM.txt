MUNDER DIFFLIN MULTI-AGENT SYSTEM - WORKFLOW DIAGRAM
=====================================================

ARCHITECTURE OVERVIEW
=====================

This system uses a multi-agent architecture with 3 specialized worker agents
coordinated by an orchestrator function.

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CUSTOMER REQUEST                          â”‚
â”‚         (e.g., "Need 500 sheets of glossy paper")           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ORCHESTRATOR FUNCTION                       â”‚
â”‚  - Analyzes customer request                                 â”‚
â”‚  - Determines request type (quote vs order)                  â”‚
â”‚  - Routes to appropriate worker agents in sequence           â”‚
â”‚  - Synthesizes responses from multiple agents                â”‚
â”‚  - Returns professional customer response                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                  â”‚                 â”‚
        STEP 1               STEP 2           STEP 3
             â”‚                  â”‚                 â”‚
             â–¼                  â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ INVENTORY AGENT   â”‚  â”‚ QUOTATION AGENT  â”‚  â”‚ SALES AGENT      â”‚
â”‚ (Worker Agent 1)  â”‚  â”‚ (Worker Agent 2) â”‚  â”‚ (Worker Agent 3) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


AGENT DETAILS
=============

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘             WORKER AGENT 1: INVENTORY AGENT                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Primary Responsibility:
  - Stock checking and inventory management
  - Financial status monitoring

Tools Assigned to This Agent:
  1. check_inventory_availability
     Purpose: Validate stock levels for requested items
     Helper functions used: get_stock_level()
     
  2. get_full_inventory_report
     Purpose: Get complete inventory snapshot
     Helper functions used: get_all_inventory()
     
  3. check_cash
     Purpose: Monitor current cash balance
     Helper functions used: get_cash_balance()
     
  4. get_financial_summary
     Purpose: Generate comprehensive financial report
     Helper functions used: generate_financial_report()

Agent Workflow:
  Input: Customer request + date
  Processing:
    1. Extract item names and quantities from request
    2. Map informal names to catalog (e.g., "glossy" â†’ "Glossy paper")
    3. Query stock levels using get_stock_level()
    4. Return availability status
  Output: Inventory availability report


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘             WORKER AGENT 2: QUOTATION AGENT                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Primary Responsibility:
  - Price calculation and quote generation
  - Historical pricing analysis

Tools Assigned to This Agent:
  1. search_past_quotes
     Purpose: Find similar historical quotes
     Helper functions used: search_quote_history()
     
  2. create_quote
     Purpose: Generate detailed price quotes with bulk discounts
     Helper functions used: Paper supplies catalog (pricing data)

Agent Workflow:
  Input: Customer request + inventory status + date
  Processing:
    1. Search historical quotes for similar orders
    2. Extract item quantities from request
    3. Calculate base prices from catalog
    4. Apply bulk discounts:
       - 15% off for 1000+ units
       - 10% off for 500+ units
       - 5% off for 100+ units
    5. Generate line-item breakdown
  Output: Detailed professional quote


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         WORKER AGENT 3: SALES-FULFILLMENT AGENT            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Primary Responsibility:
  - Order processing and transaction recording
  - Supplier coordination and restocking

Tools Assigned to This Agent:
  1. process_customer_sale
     Purpose: Process sales and record transactions
     Helper functions used: get_stock_level(), create_transaction()
     
  2. restock_from_supplier
     Purpose: Order stock from suppliers
     Helper functions used: get_cash_balance(), 
                           get_supplier_delivery_date(), 
                           create_transaction()

Agent Workflow:
  Input: Customer order + inventory status + quote + date
  Processing:
    1. Validate stock availability
    2. Record sales transaction via create_transaction()
    3. Update inventory levels
    4. Check if restocking needed
    5. If needed, order from supplier (60% of retail cost)
    6. Calculate delivery date via get_supplier_delivery_date()
  Output: Order confirmation and restock status


ORCHESTRATION FLOW
==================

Quote Request Flow:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Customer Request (Quote)
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ORCHESTRATOR            â”‚
â”‚ - Identifies as quote   â”‚
â”‚ - Routes to agents      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”œâ”€â”€> STEP 1: Inventory Agent
        â”‚    â””â”€> Check stock availability
        â”‚    â””â”€> Return: "âœ“ Item X: 500 available"
        â”‚
        â”œâ”€â”€> STEP 2: Quotation Agent
        â”‚    â””â”€> Search past quotes
        â”‚    â””â”€> Calculate prices with discounts
        â”‚    â””â”€> Return: "ğŸ’° TOTAL: $X.XX"
        â”‚
        â””â”€â”€> STEP 3: Skip (quote only, no order)
             
    Orchestrator synthesizes:
    "Thank you for your inquiry! [Quote details]
     All quoted items based on current availability."


Order Request Flow:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Customer Request (Order)
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ORCHESTRATOR            â”‚
â”‚ - Identifies as order   â”‚
â”‚ - Routes to agents      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”œâ”€â”€> STEP 1: Inventory Agent
        â”‚    â””â”€> Check stock availability
        â”‚    â””â”€> Return: "âœ“ Items available"
        â”‚
        â”œâ”€â”€> STEP 2: Quotation Agent
        â”‚    â””â”€> Generate quote with pricing
        â”‚    â””â”€> Return: "ğŸ’° TOTAL: $X.XX"
        â”‚
        â””â”€â”€> STEP 3: Sales Agent
             â””â”€> Process sale transaction
             â””â”€> Record to database
             â””â”€> Check restock needs
             â””â”€> Order from supplier if needed
             â””â”€> Return: "âœ… SALE PROCESSED!"
             
    Orchestrator synthesizes:
    "Thank you for your order! [Quote + Confirmation]
     Your order has been processed."


DECISION FLOW CHART
===================

Customer Request
    â”‚
    â–¼
[Orchestrator Analyzes Request]
    â”‚
    â”œâ”€> Extract request type
    â””â”€> Is it an order? (keywords: "order", "buy", "purchase")
    â”‚
    â”œâ”€ YES â†’ Order Flow
    â”‚   â”‚
    â”‚   â”œâ”€> Inventory Agent: Check stock
    â”‚   â”‚   â””â”€> Available? â”€YESâ†’ Continue
    â”‚   â”‚       â””â”€NOâ†’ Partial/Warning
    â”‚   â”‚
    â”‚   â”œâ”€> Quotation Agent: Generate quote
    â”‚   â”‚   â”œâ”€> Search past quotes
    â”‚   â”‚   â”œâ”€> Calculate prices
    â”‚   â”‚   â””â”€> Apply bulk discounts
    â”‚   â”‚
    â”‚   â””â”€> Sales Agent: Process order
    â”‚       â”œâ”€> Record transaction
    â”‚       â”œâ”€> Update inventory
    â”‚       â”œâ”€> Check if restock needed
    â”‚       â””â”€> Order from supplier if:
    â”‚           â”œâ”€ Inventory low? â”€YESâ†’
    â”‚           â””â”€ Cash available? â”€YESâ†’ Restock
    â”‚
    â””â”€ NO â†’ Quote Flow
        â”‚
        â”œâ”€> Inventory Agent: Check stock
        â”‚   â””â”€> Report availability
        â”‚
        â””â”€> Quotation Agent: Generate quote
            â”œâ”€> Search past quotes
            â”œâ”€> Calculate prices
            â””â”€> Apply bulk discounts


DATA FLOW BETWEEN AGENTS
=========================

Input: Customer Request + Date
   â”‚
   â–¼
Orchestrator
   â”‚
   â”œâ”€> To Inventory Agent:
   â”‚   Input: "Customer request: [text], Date: [YYYY-MM-DD]"
   â”‚   Output: "âœ“ Item A: 500 available, âš  Item B: Only 200 available"
   â”‚
   â”œâ”€> To Quotation Agent:
   â”‚   Input: "Customer request: [text], Inventory status: [from Agent 1], Date: [YYYY-MM-DD]"
   â”‚   Output: "Line items with prices, Total: $X.XX"
   â”‚
   â”œâ”€> To Sales Agent (if order):
   â”‚   Input: "Customer request: [text], Inventory: [from Agent 1], Quote: [from Agent 2], Date: [YYYY-MM-DD]"
   â”‚   Output: "âœ… Sale processed, Revenue: $X.XX, Restocked: Item Y"
   â”‚
   â””â”€> Orchestrator Output:
       Synthesized customer response combining all agent outputs


DATABASE INTERACTIONS
=====================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       DATABASE (SQLite)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  transactions                     â”‚  â”‚
â”‚  â”‚  - Sales records                  â”‚â—„â”€â”¼â”€ Sales Agent
â”‚  â”‚  - Stock orders                   â”‚  â”‚  (create_transaction)
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  inventory                        â”‚  â”‚
â”‚  â”‚  - Item catalog                   â”‚â—„â”€â”¼â”€ Inventory Agent
â”‚  â”‚  - Unit prices                    â”‚  â”‚  (get_stock_level,
â”‚  â”‚  - Stock levels                   â”‚  â”‚   get_all_inventory)
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  quotes (historical)              â”‚  â”‚
â”‚  â”‚  - Past pricing                   â”‚â—„â”€â”¼â”€ Quotation Agent
â”‚  â”‚  - Order patterns                 â”‚  â”‚  (search_quote_history)
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


HELPER FUNCTION MAPPING
========================

âœ… All 7 Required Helper Functions Used:

1. create_transaction()
   Used by: Sales Agent
   Tool: process_customer_sale, restock_from_supplier
   Purpose: Record sales and supplier orders to database

2. get_all_inventory()
   Used by: Inventory Agent
   Tool: get_full_inventory_report
   Purpose: Get complete inventory snapshot

3. get_stock_level()
   Used by: Inventory Agent, Sales Agent
   Tool: check_inventory_availability, process_customer_sale
   Purpose: Check stock for specific items

4. get_supplier_delivery_date()
   Used by: Sales Agent
   Tool: restock_from_supplier
   Purpose: Calculate delivery timeframes based on quantity

5. get_cash_balance()
   Used by: Inventory Agent, Sales Agent
   Tool: check_cash, restock_from_supplier
   Purpose: Monitor available funds

6. generate_financial_report()
   Used by: Inventory Agent
   Tool: get_financial_summary
   Purpose: Generate comprehensive financial report

7. search_quote_history()
   Used by: Quotation Agent
   Tool: search_past_quotes
   Purpose: Find similar historical quotes for pricing guidance


KEY FEATURES
============

âœ“ Multi-agent architecture with 3 specialized worker agents
âœ“ Orchestrator coordinates agents in proper sequence
âœ“ Clear separation of responsibilities (no overlap)
âœ“ Intelligent request routing (quote vs order)
âœ“ Agent-to-agent information passing via orchestrator
âœ“ All 7 required helper functions utilized
âœ“ Bulk discount system (5%, 10%, 15% tiers)
âœ“ Automatic restocking when needed
âœ“ Cash balance validation before orders
âœ“ Historical quote analysis for pricing
âœ“ Professional customer communication


AGENT COORDINATION EXAMPLES
============================

Example 1: Simple Quote Request
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Request: "I need 300 sheets of A4 paper"

1. Orchestrator â†’ Inventory Agent
   Prompt: "Check stock for A4 paper, 300 sheets, Date: 2025-04-01"
   Response: "âœ“ A4 paper: 500 available (requested 300)"

2. Orchestrator â†’ Quotation Agent
   Prompt: "Generate quote for A4 paper 300 sheets, in stock"
   Response: "300 Ã— $0.05 = $15.00 (5% bulk discount = $14.25)"

3. Orchestrator â†’ Customer
   Response: "Thank you! Quote: $14.25 for 300 A4 paper sheets"


Example 2: Large Order with Restocking
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Request: "I want to order 1000 glossy paper sheets"

1. Orchestrator â†’ Inventory Agent
   Response: "âœ“ Glossy paper: 1200 available"

2. Orchestrator â†’ Quotation Agent
   Response: "1000 Ã— $0.20 = $200 (15% discount = $170)"

3. Orchestrator â†’ Sales Agent
   Response: "âœ… Sale processed! Revenue: $170
            âš  Stock now 200 (below min 150)
            âœ… Restocked 500 units, Cost: $60, Delivery: 4 days"

4. Orchestrator â†’ Customer
   Response: "Order confirmed! Total: $170. Thank you!"


ARCHITECTURE BENEFITS
=====================

1. Separation of Concerns
   - Each agent has clear, distinct responsibility
   - No overlap between agent functions
   - Easy to test individual agents

2. Scalability
   - New agents can be added without affecting existing ones
   - Tools can be redistributed as business needs change
   - Easy to add new capabilities

3. Maintainability
   - Changes to one agent don't affect others
   - Clear code organization
   - Well-defined interfaces

4. Flexibility
   - Orchestrator can adapt routing logic
   - Agents can be called in different sequences
   - Easy to handle complex workflows

5. Robustness
   - Errors in one agent don't crash entire system
   - Orchestrator can handle agent failures gracefully
   - Each agent has focused, testable logic


WORKFLOW SUMMARY
================

The multi-agent system processes customer requests through:

1. ORCHESTRATOR analyzes request type and routes to agents
2. INVENTORY AGENT checks stock and financial status
3. QUOTATION AGENT generates pricing with discounts
4. SALES AGENT (if order) processes transaction and restocking
5. ORCHESTRATOR synthesizes professional customer response

All agents use the smolagents framework with ToolCallingAgent classes.
All 7 required helper functions are distributed across agent tools.
Clear orchestration ensures proper sequencing and data flow.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 MULTI-AGENT SYSTEM ARCHITECTURE COMPLETE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
